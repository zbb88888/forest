# Dark Forest 开发指导文档

## 文档说明
本文档是游戏开发的核心指导文档，用于管理开发需求、开发任务和开发流程。

**开发流程**：
1. 接收新的开发需求和需求澄清
2. 梳理并维护到本文档
3. 规划下一步开发任务
4. 询问是否继续开发
5. 完成独立任务后询问是否提交

---

## 当前开发阶段

**阶段**：第二阶段 - 核心玩法扩展

**目标**：实现建造（升级）系统，包括植物升级、建筑建造和装备制造

**状态**：已完成

---

## 需求记录

### 已实现需求
1. ✅ 环境系统（地图、时间、光照）
2. ✅ 植物系统（种植、生长、收获）
3. ✅ 机器人系统（AI、任务、采集）
4. ✅ 装备系统（生成、拾取、升级）
5. ✅ 玩家系统（生成、背包、装备栏）
6. ✅ UI系统（主菜单、HUD）
7. ✅ 建造（升级）系统（植物升级、建筑建造、装备制造）
8. ✅ 敌人系统（机器人、机器虫、机器鸟、敌人大本营）

### 当前需求

#### 敌人系统

**需求描述**：
敌人系统包括多种敌人类型和敌人大本营：
1. 机器人敌人（4种）：侦察机器人、战斗机器人、重型机器人、精英机器人
2. 机器虫敌人（5种）：工虫、战虫、喷吐虫、坦克虫、虫后
3. 机器鸟敌人（2种）：侦察鸟、攻击鸟
4. 敌人建筑（2种）：机器人堡垒、AI母巢

**需求澄清**：
- 机器人敌人：高阶敌人，使用激光攻击
- 机器虫敌人：近战和远程攻击
- 机器鸟敌人：低阶敌人，高速移动
- 敌人建筑：可以生成其他敌人

**依赖关系**：
- 地图系统 ✅
- 玩家系统 ✅
- AI系统（机器人系统）✅

**依赖状态**：✅ 所有依赖已完成

### 当前需求

#### 建造（升级）系统

**需求描述**：
建造（升级）系统包括三个子系统：
1. 植物升级系统
2. 建筑建造系统
3. 装备制造系统

这三种系统中的实体都可以升级。

**需求澄清**：
- 植物升级系统：植物品种升级、属性提升、特殊植物解锁
- 建筑建造系统：建筑类型定义、建造放置、功能实现、升级系统
- 装备制造系统：制造配方、材料消耗、品质控制、升级优化

**依赖关系**：
- 植物升级系统：依赖植物系统、资源系统、玩家系统
- 建筑建造系统：依赖地图系统、玩家系统、资源系统、机器人系统
- 装备制造系统：依赖装备系统、资源系统、玩家系统

**依赖状态**：✅ 所有依赖已完成

---

## 开发任务规划

### 当前任务列表

#### 任务1：敌人系统
**状态**：已完成

**子任务**：
1.1 定义敌人类型和属性 ✅
1.2 实现敌人AI系统 ✅
1.3 实现敌人生成系统 ✅
1.4 实现敌人攻击系统 ✅
1.5 实现敌人大本营系统 ✅

**预计工作量**：大

**依赖**：地图系统、玩家系统、AI系统

#### 任务2：植物升级系统
**状态**：已完成

**子任务**：
1.1 定义植物升级组件
1.2 实现植物升级UI
1.3 实现植物升级逻辑
1.4 实现植物品种解锁
1.5 实现植物属性提升

**预计工作量**：中等

**依赖**：植物系统、资源系统、玩家系统

---

#### 任务2：装备制造系统
**状态**：已完成

**子任务**：
2.1 定义装备制造配方
2.2 实现制造UI
2.3 实现制造逻辑
2.4 实现品质控制
2.5 实现升级优化

**预计工作量**：中等

**依赖**：装备系统、资源系统、玩家系统

---

#### 任务3：建筑建造系统
**状态**：已完成

**子任务**：
3.1 定义建筑类型
3.2 实现建筑放置
3.3 实现建筑功能
3.4 实现建筑升级
3.5 集成机器人建造

**预计工作量**：大

**依赖**：地图系统、玩家系统、资源系统、机器人系统

---

### 待规划任务
- 战斗系统
- 敌人系统
- 防御系统
- 任务系统
- 成就系统
- 存档系统

---

## 开发流程

### 标准开发流程

#### 1. 需求接收
- 接收新的开发需求
- 理解需求内容
- 识别需求类型（新功能/优化/修复）

#### 2. 需求澄清
- 明确需求细节
- 确认功能范围
- 识别依赖关系
- 评估工作量

#### 3. 需求记录
- 更新需求记录
- 更新依赖关系
- 更新系统文档
- 创建/更新任务规划

#### 4. 任务规划
- 分解任务为子任务
- 确定任务优先级
- 评估任务工作量
- 制定开发计划

#### 5. 开发执行
- 按计划执行任务
- 完成独立功能点
- 更新进度记录

#### 6. 任务确认
- 完成独立任务后询问是否提交
- 等待用户确认
- 根据反馈调整

#### 7. 文档更新
- 更新系统文档
- 更新依赖关系
- 更新开发进度
- 记录完成情况

---

## 开发原则

### 1. 依赖优先
- 优先实现基础系统
- 确保依赖系统已完成
- 避免循环依赖

### 2. 单一职责
- 每个系统职责明确
- 避免功能重叠
- 保持接口清晰

### 3. 渐进开发
- 从简单到复杂
- 逐步完善功能
- 及时测试集成

### 4. 文档同步
- 先更新文档
- 后执行开发
- 保持文档最新

### 5. 用户确认
- 完成独立任务后确认
- 根据反馈调整
- 确保方向正确

---

## 开发进度跟踪

### 已完成系统
- ✅ 游戏状态系统
- ✅ 地图系统
- ✅ 时间系统
- ✅ 光照系统
- ✅ 玩家系统
- ✅ 资源系统
- ✅ 植物系统
- ✅ 机器人系统
- ✅ 装备系统
- ✅ UI系统
- ✅ 建造（升级）系统
  - ✅ 植物升级系统
  - ✅ 装备制造系统
  - ✅ 建筑建造系统
- ✅ 敌人系统
  - ✅ 定义敌人类型和属性
  - ✅ 实现敌人AI系统
  - ✅ 实现敌人生成系统
  - ✅ 实现敌人攻击系统
  - ✅ 实现敌人大本营系统

### 开发中系统
- 无

### 待开发系统
- ⏳ 战斗系统
- ⏳ 敌人系统
- ⏳ 防御系统
- ⏳ 任务系统
- ⏳ 成就系统
- ⏳ 存档系统

---

## 版本历史

### v0.4.0 (当前版本)
- 完成敌人系统
  - 定义敌人类型和属性
  - 实现敌人AI系统
  - 实现敌人生成系统
  - 实现敌人攻击系统
  - 实现敌人大本营系统

### v0.3.0
- 完成建造（升级）系统
  - 完成植物升级系统
  - 完成装备制造系统
  - 完成建筑建造系统
- 所有子系统已集成到主程序

### v0.2.0
- 规划建造（升级）系统
- 定义三个子系统
- 建立开发流程

### v0.1.0
- 完成所有基础系统
- 建立文档体系
- 实现核心游戏循环
